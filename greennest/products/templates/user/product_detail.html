{% extends "base.html" %}
{% load static %}


{% block user_products_detials %}
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<style>.wishlist-icon { border: 1px solid #ddd; border-radius: 50%; padding: 10px; cursor: pointer; color: #004F44; }  </style>


<!-- Breadcrumb -->
<div class="container mt-4 mb-1">
  <nav aria-label="breadcrumb">
    <ol class="breadcrumb">
      <li class="breadcrumb-item"><a href="#">Home</a></li>
      <li class="breadcrumb-item"><a href="#">Products</a></li>
      <li class="breadcrumb-item active" aria-current="page">{{ product.name }}</li>
    </ol>
  </nav>
</div>
<!-- Main product section -->
<div class="container mb-5">
  <div class="row">
    <!-- Product Images -->
    
<div class="col-md-4 d-flex">
  <!-- Sub Images (Left, vertical) -->
  <div class="d-flex flex-column align-items-center me-3">
    {% for img in additional_images %}
    <img src="{{ img.image.url }}" 
     class="thumb-image mb-2 shadow-sm" 
     style="width:60px; height:80px; object-fit:cover; cursor:pointer;">
    {% endfor %}
  </div>
  <!-- Main Image (Big, right) -->
  <div>
    <img id="mainImage" src="{{ product.main_image.url }}" class="shadow" style="width:280px; height:360px; object-fit:cover; border-radius:12px;">
  </div>
</div>

    <!-- Product Info -->
    <div class="col-md-5 pl-5">
      <h3 class="product-title">{{ product.name }}</h3>
      <div class="mb-2">
        <span class="price">â‚¹{{ product.price }}</span>
        {% comment %} <span class="old-price">â‚¹399</span> {% endcomment %}
        <span class="offer">-40% off</span>
      </div>
      <div class="mb-2"><span class="rating">&#9733; 4.6</span> | 814 reviews</div>
      <div class="product-details mb-2">
        <ul>
          <li>Bright Indirect Sunlight</li>
          <li>{{ product.get_size_display }}</li>
          <li></strong> {{ product.get_light_requirement_display }}</li>
        </ul>
        <div class="mt-2 text-success"> <strong>Stock:</strong> :{{ product.stock }}</div>
      </div>
      <form>
        <div class="mt-3">
        <label class="fw-semibold">Select Size:</label>
        <div class="btn-group" role="group">
          <button type="button" class="btn btn-outline-dark btn-sm">Small</button>
          <button type="button" class="btn btn-outline-dark btn-sm">Medium</button>
          <button type="button" class="btn btn-outline-dark btn-sm">Large</button>
        </div>
      </div>
        <br>
        <label>Pots: </label>
        <select class="form-select d-inline-block w-auto ms-1 mb-3">
          <option>None</option>
          <option>Plastic</option>
          <option>Ceramic</option>
        </select>
        <br>
        <div class="mt-1 d-flex gap-3">
        <label>Qty: </label>
        <input type="number" value="1" min="1" max="{{ product.stock }}" class="form-control text-center" style="width:70px; height:30px;">
        
        <br>
        <!-- Add to cart & Wishlist -->
      
        <button class="btn btn-success px-4">ADD TO CART</button>
        <a href=""><i class="fa fa-heart wishlist-icon"></i></a>
      </div>
        
      </form>
    </div>
    <!-- Cart Summary -->
    <div class="col-md-3">
      <div class="cart-summary mb-4">
        <strong>Your Cart</strong>
        <div class="d-flex align-items-center mt-2">
          
          <img src="{{ product.main_image.url }}" class="me-2" style="width:50px; height:50px; object-fit:cover; border-radius:6px;">
          <div>
            <div>Air Purifier Money Plant</div>
            <div class="small text-muted">1 x â‚¹249</div>
          </div>
        </div>
        <hr>
        <div>Sub Total: <span class="float-end">â‚¹249.00</span></div>
        <button class="btn btn-dark btn-sm w-100 mt-2">View Cart</button>
        <button class="btn btn-success btn-sm w-100 mt-2">Checkout</button>
        <div class="small text-muted mt-2">Ships from Kerala GreenNest</div>
      </div>
    </div>
  </div>
</div>

<!-- Similar Collection -->
<div class="container mb-5">
  <h5>Similar Collection</h5>
  <div class="row mt-3">
    {% for related in product.category.products.all|slice:":4" %}
      {% if related.id != product.id %}
        <div class="col-6 col-md-3 mb-3 text-center">
          <a href="{% url 'user_product_detail' related.id %}">
            <img src="{{ related.main_image.url }}" class="shadow-sm"
                 style="width:100%; max-width:150px; height:180px; object-fit:cover; border-radius:8px;">
          </a>
          <div class="mt-2">{{ related.name }}</div>
          <div class="mt-2">â‚¹{{ related.price }} </div>
          <div class="mt-1 d-flex justify-content-center gap-3">
        <button class="btn btn-success  px-1">ADD TO CART</button>
        <a href=""><i class="fa fa-heart wishlist-icon"></i></a>
      </div>

        </div>
      {% endif %}
    {% endfor %}
  </div>
</div>




<script src="https://cdnjs.cloudflare.com/ajax/libs/elevatezoom/3.0.8/jquery.elevatezoom.min.js"></script>
<script>
  $(document).ready(function(){
    // Initialize zoom inside main image
    $("#mainImage").elevateZoom({
        zoomType: "inner",   // ðŸ”¹ zoom happens inside
        cursor: "crosshair"  // ðŸ”¹ shows crosshair cursor
    });

    // Thumbnail click handler (replace main image + re-init zoom)
    $(".thumb-image").on("click", function(){
      var newImage = $(this).attr("src");
      $("#mainImage").attr("src", newImage).data("zoom-image", newImage);

      // Remove old zoom container & re-init inner zoom
      $('.zoomContainer').remove();
      $("#mainImage").elevateZoom({
        zoomType: "inner",
        cursor: "crosshair"
      });
    });
  });
</script>
{% endblock user_products_detials %} 